# Benchmarks: Benchmark: Neural Network Malware Classification

## Installation
1. Install dependencies
```
conda create -y -n mal_bench pip && conda activate mal_bench && pip install -r requirements.txt
```
2. Download datasets
   1. Go [here](https://vanderbilt.box.com/s/l1f5fvu87mfd9d929k0kmxszd5v2amk1)
 and download the datasets to a folder called `datasets` in the main directory
   2. Extract the malimg tar file.
  ```
  cd datasets && tar -xvf malimg.tgz && cd ..
  ```

## Run
1. Train models
```
chmod +x train_models.sh && ./train_models.sh
```

2. Use your choice of verification tool (e.g. NNV, nnenum) to test the models with the available benchmarks.

## Organization
```
.
├── LICENSE
├── README.md
├── benchmarks                 # vnnlib benchmark files
│   ├── bodmas
│   └── malimg
├── datasets                   # (must download first)
│   ├── bodmas.npz
│   └── malimg.tgz
├── models                     # (pretrained models)
│   ├── bodmas
│   └── malimg
├── requirements.txt           # dependencies
├── src
│   ├── train                  # model training and testing files
│   └── verify                 # verification results
└── train_models.sh            # script to train all models
```
